<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.dong.catdogMapper">


	<!-- 로그인 -->
	<select id="login" parameterType="java.util.Map"
		resultType="java.util.Map">
		select user_id,name,user_auth from member
		where user_id=#{user_id} and password=#{password}
	</select>

	<!-- 카테고리 리스트 -->
	<select id="mainlist" parameterType="java.util.Map"
		resultType="ProductDTO">
		SELECT
		p.*,
		(SELECT wish_no
		FROM wish w
		WHERE w.user_id = #{user_id} AND w.product_code = p.product_code) AS
		wish_no
		FROM
		product p
		WHERE
		p.product_category = #{product_category}
		ORDER BY
		p.product_regdate DESC
	</select>

	<!-- 리스트에서 제품 선택 -->
	<select id="product_detail" parameterType="java.lang.Integer"
		resultType="BoardDTO">
		select *
		from product
		where product_code = #{product_code}
	</select>


	<insert id="addWish" parameterType="java.util.Map">
		INSERT INTO wish (user_id, product_code)
		VALUES (#{user_id}, #{product_code})
	</insert>

	<delete id="deleteWish" parameterType="java.util.Map">
		DELETE FROM wish
		WHERE user_id = #{user_id} AND product_code = #{product_code}
	</delete>

<!-- 찜 추가 제거 -->
	<!-- <insert id="addWish" parameterType="WishDTO"> insert into wish values 
		(#{user_id}, #{product_code}) </insert> <delete id="deleteWish" parameterType="WishDTO"> 
		delete from wish where user_id=#{user_id} and product_code = #{product_code} 
		</delete> -->

	<!-- 사용자 찜 목록 조회 -->
	<select id="getWish" parameterType="java.util.Map"
		resultType="ProductDTO">
		SELECT
		p.*,
		(SELECT wish_no
		FROM wish w
		WHERE w.user_id = #{user_id} AND w.product_code = p.product_code) AS
		wish_no
		FROM
		product p
		WHERE
		p.product_category = #{product_category}
		ORDER BY
		p.product_regdate DESC
	</select>
</mapper>